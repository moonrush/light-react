{"version":3,"sources":["datas/map.js","lib/easy-create/index.js","App.js","lib/util.js","reportWebVitals.js","index.js"],"names":["width","height","bgColor","minScale","maxScale","SMap","opt","_","this","stage","canvas","ctr","createjs","Container","bg","Shape","Graphics","f","dr","scale","x","y","oldDis","oldCent","oldX","oldY","_calFinger","t1","t2","Math","sqrt","pow","clientX","clientY","_setScale","s","rate","max","min","scaleX","scaleY","_calMove","mouseX","mouseY","_smapMousedown","e","ts","nativeEvent","touches","length","_smapPressmove","newDis","moveX","moveY","addEventListener","addChild","Irreg","p","ire","setTransform","App","loader","size","useState","document","documentElement","clientWidth","clientHeight","setSize","onResize","useCallback","useEffect","window","removeEventListener","GetSizeFunc","tick","update","loaded","map","Bitmap","getResult","ReactDom","findDOMNode","querySelector","Stage","Touch","enable","LoadQueue","loadManifest","src","id","Ticker","timingMode","RAF","className","style","transform","abs","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.225f1d5a.chunk.js","sourcesContent":["export default {\r\n    width: 1890,\r\n    height: 1890,\r\n    bgColor: '#eee',\r\n    minScale: 0.5,\r\n    maxScale: 2\r\n}","import createjs from 'createjs-cmd'\r\n\r\n/**\r\n * 构建可移动缩放的地图\r\n * @param {*} opt \r\n */\r\nconst SMap = function (opt) {\r\n    const _ = this\r\n    _.stage = opt.stage                 // 舞台对象\r\n    _.canvas = opt.stage.canvas         // canvas Node\r\n    _.bgColor = opt.bgColor || '#eee'   // 默认背景颜色\r\n    _.width = opt.width || 500          // 宽度\r\n    _.height = opt.height || 550        // 高度\r\n    _.maxScale = opt.maxScale || 2      // 最大放大倍率\r\n    _.minScale = opt.minScale || 0.5    // 最校放大倍率\r\n\r\n    let ctr = new createjs.Container()\r\n\r\n    _.bg = new createjs.Shape(\r\n        new createjs.Graphics().f(_.bgColor).dr(0, 0, _.width, _.height)\r\n    )\r\n\r\n    // 初始化位置和缩放大小\r\n    ctr.scale = 1\r\n    ctr.width = _.width\r\n    ctr.height = _.height\r\n    ctr.x = (_.canvas.width - _.width) / 2 * ctr.scale\r\n    ctr.y = (_.canvas.height - _.height) / 2 * ctr.scale\r\n\r\n    // 初始化辅助值\r\n    _.oldDis = _.oldCent = 0\r\n    _.oldX = _.oldY = 0\r\n\r\n\r\n    /**\r\n     * 计算两个点之间的距离和中点\r\n     * @param {*} t1 \r\n     * @param {*} t2 \r\n     * @returns \r\n     */\r\n    _._calFinger = (t1, t2) => {\r\n        let dis = Math.sqrt(\r\n            Math.pow(t1.clientX - t2.clientX, 2) +\r\n            Math.pow(t1.clientY - t2.clientY, 2)\r\n        )\r\n        let cent = {\r\n            x: (t1.clientX + t2.clientX) / 2,\r\n            y: (t1.clientY + t2.clientY) / 2\r\n        }\r\n        return [dis, cent]\r\n    }\r\n\r\n    /**\r\n     * 设置container缩放倍率\r\n     * @param {*}} s \r\n     * @param {*} rate \r\n     */\r\n    _._setScale = (s, rate = 0.05) => {\r\n        // 设置速率\r\n        s = rate * s + (1 - rate)\r\n\r\n        let scale = Math.max(Math.min(_.maxScale, s * ctr.scale), _.minScale)\r\n\r\n        ctr.width = _.width * scale\r\n        ctr.height = _.height * scale\r\n\r\n        ctr.x = _.oldCent.x - (_.oldCent.x - ctr.x) * scale / ctr.scale\r\n        ctr.y = _.oldCent.y - (_.oldCent.y - ctr.y) * scale / ctr.scale\r\n\r\n        ctr.x = Math.max(Math.min(ctr.x, 0), _.canvas.width - ctr.width)\r\n        ctr.y = Math.max(Math.min(ctr.y, 0), _.canvas.height - ctr.height)\r\n\r\n        ctr.scale = ctr.scaleX = ctr.scaleY = scale\r\n    }\r\n\r\n    /**\r\n     * 计算手指移动距离\r\n     * @returns \r\n     */\r\n    _._calMove = () => {\r\n        let x = _.stage.mouseX - _.oldX\r\n        let y = _.stage.mouseY - _.oldY\r\n\r\n        _.oldX = _.stage.mouseX\r\n        _.oldY = _.stage.mouseY\r\n        return [x, y]\r\n    }\r\n\r\n    /**\r\n     * 按下触发事件\r\n     * @param {*} e \r\n     * @returns \r\n     */\r\n    _._smapMousedown = (e) => {\r\n        let ts = e.nativeEvent.touches\r\n        if (ts.length >= 2) {\r\n            [_.oldDis, _.oldCent] = _._calFinger(ts[0], ts[1])\r\n            return true\r\n        }\r\n        [_.oldX, _.oldY] = [_.stage.mouseX, _.stage.mouseY]\r\n    }\r\n\r\n    /**\r\n     * 移动触发事件\r\n     * @param {*} e \r\n     * @returns \r\n     */\r\n    _._smapPressmove = (e) => {\r\n        // multi-operate\r\n        let ts = e.nativeEvent.touches\r\n        if (ts.length >= 2) {\r\n            let [newDis, newCent] = _._calFinger(ts[0], ts[1])\r\n            _._setScale(newDis / _.oldDis)\r\n            return true\r\n        }\r\n\r\n        // calculate move x,y\r\n        let [moveX, moveY] = _._calMove()\r\n\r\n        // set x,y\r\n        ctr.x = Math.max(Math.min(ctr.x + moveX, 0), _.canvas.width - ctr.width)\r\n        ctr.y = Math.max(Math.min(ctr.y + moveY, 0), _.canvas.height - ctr.height)\r\n    }\r\n\r\n    ctr.addEventListener('mousedown', _._smapMousedown)\r\n    ctr.addEventListener('pressmove', _._smapPressmove)\r\n\r\n    ctr.addChild(_.bg)\r\n\r\n    return ctr\r\n}\r\n\r\n/**\r\n * 绘制不规则图形\r\n * @param {*} opt\r\n *  x,y 相对于全画布的位置，通常是底图container\r\n */\r\nconst Irreg = function (opt) {\r\n    const _ = this\r\n    _.x = opt.x || 0\r\n    _.y = opt.y || 0\r\n    _.s = opt.s || '#000'\r\n    _.f = opt.f || '#fff'\r\n    _.p = opt.p || ''\r\n\r\n    let ire = new createjs.Shape(\r\n        new createjs.Graphics().s(_.s).f(_.f).p(_.p)\r\n    )\r\n    ire.setTransform(_.x, _.y)\r\n\r\n    return ire\r\n}\r\n\r\nexport {\r\n    SMap,\r\n    Irreg\r\n}","import './App.css'\nimport createjs from 'createjs-cmd'\nimport { useEffect } from 'react'\nimport { GetSizeFunc } from './lib/util'\nimport ReactDom from 'react-dom'\nimport map from './datas/map'\nimport { SMap, Irreg } from './lib/easy-create'\n\n\nfunction App() {\n    let canvas, stage, loader\n    let size = GetSizeFunc()\n\n    const tick = () => {\n        stage.update()\n    }\n\n    /**\n     * 资源已加载，绘制图形\n     */\n    const loaded = () => {\n        let ctr = new SMap(map)\n        let bg = new createjs.Bitmap(loader.getResult('bg'))\n        ctr.addChild(bg)\n\n        let ire = new Irreg({ p: 'AgqCJQgPgSgHgCIgBAAQAMgHAHgOQAGgNABgQQABgLgDgUQgCgWAAgJQAAgNAEgdQAFgcgBgPIgEgqQADAFAGADQAGACAFgCIAEgiQAEgBADADQADAEABAFIACAJQABAGACACQADACAGAAQAHAAADABQAGADADAOQAEANAGACQADABAIgBQAHgBADACQAJAFgFANIgEAJIgDAKIgBAGQAAADgCACIgIADQgHACAAAPIABAaQAAASAJAFIAJAFQAEADABAJQABAcgDAZIgBAFQgSgDgWAKQgSAJgOAQIgJAIIgEABQgHAAgKgMg', x: 100, y: 100 })\n\n        ctr.addChild(ire)\n\n        window.ctr = ctr\n        stage.addChild(ctr)\n    }\n\n    /**\n     * 只执行一次\n     */\n    useEffect(() => {\n        canvas = ReactDom.findDOMNode(\n            document.querySelector('.stage')\n        )\n        stage = new createjs.Stage(canvas)\n        createjs.Touch.enable(stage, false, true)\n\n        loader = new createjs.LoadQueue(false)\n        loader.loadManifest([{\n            src: 'img/bg.jpg',\n            id: 'bg'\n        }], true)\n\n        loader.addEventListener('complete', loaded)\n        map.stage = stage\n\n        createjs.Ticker.timingMode = createjs.Ticker.RAF\n        createjs.Ticker.addEventListener('tick', tick)\n    }, [])\n\n    return (\n        <div className=\"App\">\n            <canvas className=\"stage\" width={Math.min(size.width, size.height)} height={Math.max(size.height, size.width)}\n                style={size.width > size.height ? { transform: `matrix(0,-1,1,0,0,${-Math.abs((size.height - size.width) / 2)})` } : {}}></canvas>\n        </div>\n    );\n}\n\nexport default App\n","import { useCallback, useEffect, useState } from 'react'\r\n\r\nconst GetSizeFunc = () => {\r\n    const [size, setSize] = useState({\r\n        width: document.documentElement.clientWidth,\r\n        height: document.documentElement.clientHeight,\r\n    })\r\n\r\n    const onResize = useCallback(() => {\r\n        setSize({\r\n            width: document.documentElement.clientWidth,\r\n            height: document.documentElement.clientHeight,\r\n        })\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        window.addEventListener('resize', onResize)\r\n        return () => {\r\n            window.removeEventListener('resize', onResize)\r\n        }\r\n    }, [onResize])\r\n\r\n    return size\r\n}\r\n\r\nexport {\r\n    GetSizeFunc\r\n}","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}