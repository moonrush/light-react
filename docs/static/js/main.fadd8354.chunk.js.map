{"version":3,"sources":["lib/util.js","datas/map.js","datas/area.js","lib/easy-create/index.js","App/App.js","Home/Home.js","Share/Share.js","reportWebVitals.js","index.js"],"names":["isNeedRotate","ori","window","orientation","map","width","height","bgColor","minScale","maxScale","area","id","name","x","y","p","msg","SMap","opt","_","this","stage","canvas","ctr","createjs","Container","bg","Shape","Graphics","f","dr","scale","oldDis","oldCent","oldX","oldY","_calFinger","t1","t2","Math","sqrt","pow","clientX","clientY","_setScale","s","rate","max","min","scaleX","scaleY","_calMove","mouseX","mouseY","_smapMousedown","e","ts","nativeEvent","touches","length","_smapPressmove","newDis","moveX","moveY","addEventListener","addChild","Irreg","ire","setTransform","App","props","size","useState","document","documentElement","clientWidth","clientHeight","setSize","onResize","useCallback","useEffect","removeEventListener","GetSizeFunc","setCanvas","setStage","loader","setLoader","openNotification","key","btn","type","onClick","history","push","skip","notification","open","message","description","placement","tick","update","loaded","Bitmap","getResult","forEach","item","ReactDom","findDOMNode","querySelector","Stage","Touch","enable","LoadQueue","loadManifest","src","Ticker","timingMode","RAF","className","style","transform","abs","withRouter","href","console","log","html2canvas","logging","useCORS","then","dataUrl","toDataURL","img","Image","screen","append","display","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","path","exact","component","Home","Share","getElementById"],"mappings":"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","file":"static/js/main.fadd8354.chunk.js","sourcesContent":["import { useCallback, useEffect, useState } from 'react'\r\n\r\nconst GetSizeFunc = () => {\r\n    const [size, setSize] = useState({\r\n        width: document.documentElement.clientWidth,\r\n        height: document.documentElement.clientHeight,\r\n    })\r\n\r\n    const onResize = useCallback(() => {\r\n        setSize({\r\n            width: document.documentElement.clientWidth,\r\n            height: document.documentElement.clientHeight,\r\n        })\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        window.addEventListener('resize', onResize)\r\n        return () => {\r\n            window.removeEventListener('resize', onResize)\r\n        }\r\n    }, [onResize])\r\n\r\n    return size\r\n}\r\n\r\n/**\r\n * 判断是否需要旋转\r\n * @returns \r\n */\r\nconst isNeedRotate = () => {\r\n    let ori = window.orientation\r\n    if (ori === 90 || ori === -90) {\r\n        return true\r\n    }\r\n    return false\r\n    // if (isNaN(ori)) {\r\n    //     return false\r\n    // }\r\n    // if (ori === 180 || ori === 0) {\r\n    //     return false\r\n    // }    \r\n}\r\n\r\n// /**\r\n//  * 判断你是否为nan\r\n//  * @param {*} n \r\n//  * @returns \r\n//  */\r\n//  const isNaN = n => {\r\n//     return n !== n\r\n// }\r\n\r\n// const loading = () => {\r\n\r\n// }\r\n\r\n// const loaded = () => {\r\n\r\n// }\r\n\r\n// const mark = () => {\r\n\r\n// }\r\n\r\n// const unmark = () => {\r\n\r\n// }\r\n\r\nexport {\r\n    GetSizeFunc,\r\n    isNeedRotate\r\n}","const map = {\r\n    width: 1890,\r\n    height: 1890,\r\n    bgColor: '#eee',\r\n    minScale: 0.5,\r\n    maxScale: 2\r\n}\r\n\r\nexport default map","const area = [\r\n    {\r\n        id: 'shanghai',\r\n        name: '上海',\r\n        x: 100,\r\n        y: 100,\r\n        p: 'AgqCJQgPgSgHgCIgBAAQAMgHAHgOQAGgNABgQQABgLgDgUQgCgWAAgJQAAgNAEgdQAFgcgBgPIgEgqQADAFAGADQAGACAFgCIAEgiQAEgBADADQADAEABAFIACAJQABAGACACQADACAGAAQAHAAADABQAGADADAOQAEANAGACQADABAIgBQAHgBADACQAJAFgFANIgEAJIgDAKIgBAGQAAADgCACIgIADQgHACAAAPIABAaQAAASAJAFIAJAFQAEADABAJQABAcgDAZIgBAFQgSgDgWAKQgSAJgOAQIgJAIIgEABQgHAAgKgMg',\r\n        msg: '中共一大'\r\n    },\r\n    {\r\n        id: 'beijing',\r\n        name: '北京',\r\n        x: 200,\r\n        y: 200,\r\n        p: 'AgqCJQgPgSgHgCIgBAAQAMgHAHgOQAGgNABgQQABgLgDgUQgCgWAAgJQAAgNAEgdQAFgcgBgPIgEgqQADAFAGADQAGACAFgCIAEgiQAEgBADADQADAEABAFIACAJQABAGACACQADACAGAAQAHAAADABQAGADADAOQAEANAGACQADABAIgBQAHgBADACQAJAFgFANIgEAJIgDAKIgBAGQAAADgCACIgIADQgHACAAAPIABAaQAAASAJAFIAJAFQAEADABAJQABAcgDAZIgBAFQgSgDgWAKQgSAJgOAQIgJAIIgEABQgHAAgKgMg',\r\n        msg: '北京啦啦啦啦'\r\n    }\r\n]\r\n\r\nexport default area","import createjs from 'createjs-cmd'\r\n\r\n/**\r\n * 构建可移动缩放的地图\r\n * @param {*} opt \r\n */\r\nconst SMap = function (opt) {\r\n    const _ = this\r\n    _.stage = opt.stage                 // 舞台对象\r\n    _.canvas = opt.stage.canvas         // canvas Node\r\n    _.bgColor = opt.bgColor || '#eee'   // 默认背景颜色\r\n    _.width = opt.width || 500          // 宽度\r\n    _.height = opt.height || 550        // 高度\r\n    _.maxScale = opt.maxScale || 2      // 最大放大倍率\r\n    _.minScale = opt.minScale || 0.5    // 最校放大倍率\r\n\r\n    let ctr = new createjs.Container()\r\n\r\n    _.bg = new createjs.Shape(\r\n        new createjs.Graphics().f(_.bgColor).dr(0, 0, _.width, _.height)\r\n    )\r\n\r\n    // 初始化位置和缩放大小\r\n    ctr.scale = 1\r\n    ctr.width = _.width\r\n    ctr.height = _.height\r\n    ctr.x = (_.canvas.width - _.width) / 2 * ctr.scale\r\n    ctr.y = (_.canvas.height - _.height) / 2 * ctr.scale\r\n\r\n    // 初始化辅助值\r\n    _.oldDis = _.oldCent = 0\r\n    _.oldX = _.oldY = 0\r\n\r\n\r\n    /**\r\n     * 计算两个点之间的距离和中点\r\n     * @param {*} t1 \r\n     * @param {*} t2 \r\n     * @returns \r\n     */\r\n    _._calFinger = (t1, t2) => {\r\n        let dis = Math.sqrt(\r\n            Math.pow(t1.clientX - t2.clientX, 2) +\r\n            Math.pow(t1.clientY - t2.clientY, 2)\r\n        )\r\n        let cent = {\r\n            x: (t1.clientX + t2.clientX) / 2,\r\n            y: (t1.clientY + t2.clientY) / 2\r\n        }\r\n        return [dis, cent]\r\n    }\r\n\r\n    /**\r\n     * 设置container缩放倍率\r\n     * @param {*}} s \r\n     * @param {*} rate \r\n     */\r\n    _._setScale = (s, rate = 0.05) => {\r\n        // 设置速率\r\n        s = rate * s + (1 - rate)\r\n\r\n        let scale = Math.max(Math.min(_.maxScale, s * ctr.scale), _.minScale)\r\n\r\n        ctr.width = _.width * scale\r\n        ctr.height = _.height * scale\r\n\r\n        ctr.x = _.oldCent.x - (_.oldCent.x - ctr.x) * scale / ctr.scale\r\n        ctr.y = _.oldCent.y - (_.oldCent.y - ctr.y) * scale / ctr.scale\r\n\r\n        ctr.x = Math.max(Math.min(ctr.x, 0), _.canvas.width - ctr.width)\r\n        ctr.y = Math.max(Math.min(ctr.y, 0), _.canvas.height - ctr.height)\r\n\r\n        ctr.scale = ctr.scaleX = ctr.scaleY = scale\r\n    }\r\n\r\n    /**\r\n     * 计算手指移动距离\r\n     * @returns \r\n     */\r\n    _._calMove = () => {\r\n        let x = _.stage.mouseX - _.oldX\r\n        let y = _.stage.mouseY - _.oldY\r\n\r\n        _.oldX = _.stage.mouseX\r\n        _.oldY = _.stage.mouseY\r\n        return [x, y]\r\n    }\r\n\r\n    /**\r\n     * 按下触发事件\r\n     * @param {*} e \r\n     * @returns \r\n     */\r\n    _._smapMousedown = (e) => {\r\n        let ts = e.nativeEvent.touches\r\n        if (ts && ts.length >= 2) {\r\n            [_.oldDis, _.oldCent] = _._calFinger(ts[0], ts[1])\r\n            return true\r\n        }\r\n        [_.oldX, _.oldY] = [_.stage.mouseX, _.stage.mouseY]\r\n    }\r\n\r\n    /**\r\n     * 移动触发事件\r\n     * @param {*} e \r\n     * @returns \r\n     */\r\n    _._smapPressmove = (e) => {\r\n        // multi-operate\r\n        let ts = e.nativeEvent.touches\r\n        if (ts && ts.length >= 2) {\r\n            let [newDis,] = _._calFinger(ts[0], ts[1])\r\n            _._setScale(newDis / _.oldDis)\r\n            return true\r\n        }\r\n\r\n        // calculate move x,y\r\n        let [moveX, moveY] = _._calMove()\r\n\r\n        // set x,y\r\n        ctr.x = Math.max(Math.min(ctr.x + moveX, 0), _.canvas.width - ctr.width)\r\n        ctr.y = Math.max(Math.min(ctr.y + moveY, 0), _.canvas.height - ctr.height)\r\n    }\r\n\r\n    ctr.addEventListener('mousedown', _._smapMousedown)\r\n    ctr.addEventListener('pressmove', _._smapPressmove)\r\n\r\n    ctr.addChild(_.bg)\r\n\r\n    return ctr\r\n}\r\n\r\n/**\r\n * 绘制不规则图形\r\n * @param {*} opt\r\n *  x,y 相对于全画布的位置，通常是底图container\r\n */\r\nconst Irreg = function (opt) {\r\n    const _ = this\r\n    _.x = opt.x || 0\r\n    _.y = opt.y || 0\r\n    _.s = opt.s || '#000'\r\n    _.f = opt.f || '#fff'\r\n    _.p = opt.p || ''\r\n\r\n    let ire = new createjs.Shape(\r\n        new createjs.Graphics().s(_.s).f(_.f).p(_.p)\r\n    )\r\n    ire.setTransform(_.x, _.y)\r\n\r\n    return ire\r\n}\r\n\r\nexport {\r\n    SMap,\r\n    Irreg\r\n}","import './App.css'\nimport createjs from 'createjs-cmd'\nimport { useEffect, useState } from 'react'\nimport { GetSizeFunc, isNeedRotate } from '../lib/util'\nimport ReactDom from 'react-dom'\nimport map from '../datas/map'\nimport area from '../datas/area'\nimport { SMap, Irreg } from '../lib/easy-create'\nimport { notification, Button } from 'antd'\n\n\n\nfunction App(props) {\n    let size = GetSizeFunc()\n\n    const [canvas, setCanvas] = useState()\n    const [stage, setStage] = useState()\n    const [loader, setLoader] = useState()\n\n    const skip = (key) => {\n        props.history.push(`/share?id=${key}`)\n    }\n\n    const openNotification = (key, name, msg) => {\n        const btn = (\n            <Button type=\"primary\" size=\"small\" onClick={() => skip(key)}>\n                点亮它\n            </Button>\n        )\n        notification.open({\n            message: name,\n            description: msg,\n            btn,\n            key,\n            placement: 'bottomRight'\n        })\n    }\n\n    const tick = () => {\n        stage.update()\n    }\n\n    /**\n     * 资源已加载，绘制图形\n     */\n    const loaded = () => {\n        let ctr = new SMap(map)\n        let bg = new createjs.Bitmap(loader.getResult('bg'))\n        ctr.addChild(bg)\n\n        area.forEach(item => {\n            let ire = new Irreg({ p: item.p, x: item.x, y: item.y })\n            ire.addEventListener('click', () => {\n                openNotification(item.id, item.name, item.msg)\n            })\n            ctr.addChild(ire)\n        })\n\n        window.ctr = ctr\n        stage.addChild(ctr)\n    }\n\n    /**\n     * 只执行一次\n     */\n    useEffect(() => {\n        setCanvas(ReactDom.findDOMNode(\n            document.querySelector('.stage')\n        ))\n    }, [])\n\n    useEffect(() => {\n        if (canvas) {\n            setStage(new createjs.Stage(canvas))\n        }        \n    }, [canvas])\n\n    useEffect(() => {\n        if (stage) {\n            createjs.Touch.enable(stage, false, true)\n            setLoader(new createjs.LoadQueue(false))\n        }\n    }, [stage])\n\n    useEffect(() => {\n        if (loader) {\n            loader.loadManifest([{\n                src: 'img/bg.jpg',\n                id: 'bg'\n            }], true)\n\n            loader.addEventListener('complete', loaded)\n            map.stage = stage\n\n            createjs.Ticker.timingMode = createjs.Ticker.RAF\n            createjs.Ticker.addEventListener('tick', tick)\n        }\n    }, [loader])\n\n\n    return (\n        <div className=\"App\">\n            <canvas className=\"stage\" width={isNeedRotate() ? size.height : size.width} height={isNeedRotate() ? size.width : size.height}\n                style={isNeedRotate() ? { transform: `matrix(0,-1,1,0,0,${-Math.abs((size.height - size.width) / 2)})` } : {}}></canvas>\n        </div>\n    )\n}\n\nexport default App\n","import './Home.css'\r\nimport { withRouter } from \"react-router-dom\"\r\n\r\nfunction Home(props) {\r\n    const go = () => {\r\n        props.history.push('/play')\r\n    }\r\n    return (\r\n        <div className=\"Home\">\r\n            <div className=\"Home-background\">\r\n            </div>\r\n            <div className=\"Home-title\">\r\n                百年党史、点亮家乡\r\n            </div>\r\n            <div className=\"Home-go\">\r\n                <div className=\"Home-go-btn\" onClick={go}>\r\n                    马上去点亮\r\n                </div>\r\n            </div>\r\n            <div className=\"Home-link\">\r\n                <div className=\"Home-link-btn\">\r\n                    百年视频\r\n                </div>\r\n                <div className=\"Home-link-btn\">\r\n                    挑战答题\r\n                </div>\r\n                <div className=\"Home-link-btn\">\r\n                    红色足迹\r\n                </div>\r\n            </div>\r\n            <div className=\"Home-right\">\r\n                <p>新华社</p>\r\n                <p>中国地图出版集团</p>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default withRouter(Home)","import './Share.css'\r\nimport { withRouter } from \"react-router-dom\"\r\nimport html2canvas from 'html2canvas'\r\n\r\nfunction Share(props) {\r\n    const screenClip = () => {\r\n        console.log(1)\r\n        html2canvas(document.querySelector('.Share'), { scale: 1, logging: false, useCORS: true }).\r\n            then(function (canvas) {\r\n                let dataUrl = canvas.toDataURL();\r\n                // console.log(dataUrl)\r\n\r\n                let img = new Image()\r\n                img.src = dataUrl\r\n                img.style.width = '100%'\r\n                img.style.height = '100%'\r\n                // img.classList.add('show')\r\n\r\n                let screen = document.querySelector('.screen')\r\n                console.log(img)\r\n                screen.append(img)\r\n                screen.style.display = 'block'\r\n            })\r\n    }\r\n    return (\r\n        <div className=\"Share\">\r\n            <div className=\"Share-background\">\r\n            </div>\r\n\r\n            <div className=\"Share-title\">\r\n                上海市\r\n            </div>\r\n\r\n            <div className=\"Share-link\">\r\n                <div className=\"Share-link-btn\">\r\n                    <a href=\"#\">▶ 播放</a>\r\n                </div>\r\n                <div className=\"Share-link-btn\" onClick={screenClip}>\r\n                    生成截图\r\n                </div>\r\n                <div className=\"Share-link-btn\">\r\n                    <a href=\"#\">点击分享</a>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"Share-right\">\r\n                <p>新华社</p>\r\n                <p>中国地图出版集团</p>\r\n            </div>\r\n\r\n            <div className=\"screen\"></div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default withRouter(Share)","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './App/App'\nimport Home from './Home/Home'\nimport Share from './Share/Share'\nimport reportWebVitals from './reportWebVitals'\nimport { HashRouter as Router, Route } from \"react-router-dom\"\n\nReactDOM.render(\n    <React.StrictMode>\n        <Router>\n            <Route path=\"/\" exact component={Home} />\n            <Route path=\"/play\" component={App} />\n            <Route path=\"/share\" component={Share} />\n        </Router>\n    </React.StrictMode>,\n    document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}